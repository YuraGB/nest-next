{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { ApolloClient, ApolloProvider, HttpLink, InMemoryCache } from \"@apollo/client\";\nvar globalApolloClient;\n\nfunction initApolloClient(initialState) {\n  if (!globalApolloClient) {\n    globalApolloClient = new ApolloClient({\n      link: new HttpLink({\n        uri: \"https://localhost:3000/graphql\"\n      }),\n      cache: new InMemoryCache().restore(initialState || {})\n    });\n  } // client side page transition to an SSG page => update Apollo cache\n  else if (initialState) {\n      globalApolloClient.cache.restore(_objectSpread(_objectSpread({}, globalApolloClient.cache.extract()), initialState));\n    }\n\n  return globalApolloClient;\n}\n\nexport default function withApollo(PageComponent) {\n  var WithApollo = function WithApollo(_ref) {\n    var apolloStaticCache = _ref.apolloStaticCache,\n        pageProps = _objectWithoutProperties(_ref, [\"apolloStaticCache\"]);\n\n    // HERE WE USE THE PASSED CACHE\n    var client = initApolloClient(apolloStaticCache); // and here we have the initialized client ðŸ™‚\n\n    console.log(client);\n    return __jsx(ApolloProvider, {\n      client: client\n    }, __jsx(PageComponent, pageProps));\n  }; // if you also use it for SSR\n\n\n  if (PageComponent.getInitialProps) {\n    WithApollo.getInitialProps = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var pageProps;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              // Run wrapped getInitialProps methods\n              pageProps = {};\n\n              if (!PageComponent.getInitialProps) {\n                _context.next = 5;\n                break;\n              }\n\n              _context.next = 4;\n              return PageComponent.getInitialProps(ctx);\n\n            case 4:\n              pageProps = _context.sent;\n\n            case 5:\n              return _context.abrupt(\"return\", pageProps);\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n  } // Set the correct displayName in development\n\n\n  if (true) {\n    var displayName = PageComponent.displayName || PageComponent.name || \"Component\";\n    WithApollo.displayName = \"withApollo(\".concat(displayName, \")\");\n  }\n\n  return WithApollo;\n}","map":{"version":3,"sources":["/home/yurii/Projects/nestandnext/lib/withApollo.js"],"names":["ApolloClient","ApolloProvider","HttpLink","InMemoryCache","globalApolloClient","initApolloClient","initialState","link","uri","cache","restore","extract","withApollo","PageComponent","WithApollo","apolloStaticCache","pageProps","client","console","log","getInitialProps","ctx","displayName","name"],"mappings":";;;;;;;;;;;AACA,SACIA,YADJ,EAEIC,cAFJ,EAGIC,QAHJ,EAIIC,aAJJ,QAKO,gBALP;AAOA,IAAIC,kBAAJ;;AAEA,SAASC,gBAAT,CAA0BC,YAA1B,EAAwC;AACpC,MAAI,CAACF,kBAAL,EAAyB;AACrBA,IAAAA,kBAAkB,GAAG,IAAIJ,YAAJ,CAAiB;AAClCO,MAAAA,IAAI,EAAE,IAAIL,QAAJ,CAAa;AACfM,QAAAA,GAAG,EAAE;AADU,OAAb,CAD4B;AAIlCC,MAAAA,KAAK,EAAE,IAAIN,aAAJ,GAAoBO,OAApB,CAA4BJ,YAAY,IAAI,EAA5C;AAJ2B,KAAjB,CAArB;AAMH,GAPD,CAQA;AARA,OASK,IAAIA,YAAJ,EAAkB;AACnBF,MAAAA,kBAAkB,CAACK,KAAnB,CAAyBC,OAAzB,iCACON,kBAAkB,CAACK,KAAnB,CAAyBE,OAAzB,EADP,GAEOL,YAFP;AAIH;;AACD,SAAOF,kBAAP;AACH;;AAED,eAAe,SAASQ,UAAT,CAAoBC,aAApB,EAAmC;AAC9C,MAAMC,UAAU,GAAG,SAAbA,UAAa,OAAyC;AAAA,QAAtCC,iBAAsC,QAAtCA,iBAAsC;AAAA,QAAhBC,SAAgB;;AACxD;AACA,QAAMC,MAAM,GAAGZ,gBAAgB,CAACU,iBAAD,CAA/B,CAFwD,CAGxD;;AACAG,IAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;AACA,WACI,MAAC,cAAD;AAAgB,MAAA,MAAM,EAAEA;AAAxB,OACI,MAAC,aAAD,EAAmBD,SAAnB,CADJ,CADJ;AAKH,GAVD,CAD8C,CAY9C;;;AACA,MAAIH,aAAa,CAACO,eAAlB,EAAmC;AAC/BN,IAAAA,UAAU,CAACM,eAAX,yEAA6B;AAAA;AAAA;AAAA;AAAA;AAAA;AACzB;AACIJ,cAAAA,SAFqB,GAET,EAFS;;AAAA,mBAGrBH,aAAa,CAACO,eAHO;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAIHP,aAAa,CAACO,eAAd,CAA8BC,GAA9B,CAJG;;AAAA;AAIrBL,cAAAA,SAJqB;;AAAA;AAAA,+CAMlBA,SANkB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA7B;AAQH,GAtB6C,CAwB9C;;;AACA,YAA2C;AACvC,QAAMM,WAAW,GACbT,aAAa,CAACS,WAAd,IAA6BT,aAAa,CAACU,IAA3C,IAAmD,WADvD;AAGAT,IAAAA,UAAU,CAACQ,WAAX,wBAAuCA,WAAvC;AACH;;AACD,SAAOR,UAAP;AACH","sourcesContent":["\nimport {\n    ApolloClient,\n    ApolloProvider,\n    HttpLink,\n    InMemoryCache\n} from \"@apollo/client\";\n\nlet globalApolloClient;\n\nfunction initApolloClient(initialState) {\n    if (!globalApolloClient) {\n        globalApolloClient = new ApolloClient({\n            link: new HttpLink({\n                uri: \"https://localhost:3000/graphql\"\n            }),\n            cache: new InMemoryCache().restore(initialState || {})\n        });\n    }\n    // client side page transition to an SSG page => update Apollo cache\n    else if (initialState) {\n        globalApolloClient.cache.restore({\n            ...globalApolloClient.cache.extract(),\n            ...initialState\n        });\n    }\n    return globalApolloClient;\n}\n\nexport default function withApollo(PageComponent) {\n    const WithApollo = ({ apolloStaticCache, ...pageProps }) => {\n        // HERE WE USE THE PASSED CACHE\n        const client = initApolloClient(apolloStaticCache);\n        // and here we have the initialized client ðŸ™‚\n        console.log(client);\n        return (\n            <ApolloProvider client={client}>\n                <PageComponent {...pageProps} />\n            </ApolloProvider>\n        );\n    };\n    // if you also use it for SSR\n    if (PageComponent.getInitialProps) {\n        WithApollo.getInitialProps = async () => {\n            // Run wrapped getInitialProps methods\n            let pageProps = {};\n            if (PageComponent.getInitialProps) {\n                pageProps = await PageComponent.getInitialProps(ctx);\n            }\n            return pageProps;\n        };\n    }\n\n    // Set the correct displayName in development\n    if (process.env.NODE_ENV !== \"production\") {\n        const displayName =\n            PageComponent.displayName || PageComponent.name || \"Component\";\n\n        WithApollo.displayName = `withApollo(${displayName})`;\n    }\n    return WithApollo;\n}"]},"metadata":{},"sourceType":"module"}